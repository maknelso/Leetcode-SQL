


2. Project Employees III

SELECT project_id, employee_id
FROM Project JOIN Employee USING(employee_id)
WHERE(project_id, experience_years) IN(SELECT project_id, MAX(experience_years)       /*need to group project_id, experience_years together*/
                                       FROM Employee JOIN Project USING(employee_id)
                                       GROUP BY project_id);


3. Active Business - harder

SELECT business_id
FROM Events E1 JOIN
(SELECT event_type, AVG(occurences) AS events_avg
 FROM Events GROUP BY event_type) E2
ON E1.event_type = E2.event_type
GROUP BY business_id
HAVING SUM(CASE WHEN E1.occurences > E2.events_avg THEN 1 ELSE 0 END) > 1;
